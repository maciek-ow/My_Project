  
- name: Create .env file
  ansible.builtin.template:
    src: templates/env.j2
    dest: /opt/WebApp/app/.env
    owner: ec2-user
    group: ec2-user
    mode: '600' # Owner can read/write, no other access
    
- name: Start/update Docker Compose services
  community.docker.docker_compose_v2:
    project_src: /opt/WebApp/app
    state: present            
    pull: never              
    build: never               
    recreate: always           
    remove_orphans: true                 
  register: compose_output

- name: Delete .env file
  ansible.builtin.file:
    path: /opt/WebApp/app/.env
    state: absent
  
